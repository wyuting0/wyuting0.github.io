<script is:inline>
  // Favicon theme switcher for system theme-based favicon updates using PNG files
  class FaviconThemeSwitcher {
    constructor() {
      this.faviconLink =
        document.querySelector('link[rel="icon"]') ||
        document.querySelector('link[rel="shortcut icon"]') ||
        document.querySelector('link[rel="apple-touch-icon"]')

      if (!this.faviconLink) {
        console.warn('Favicon link not found, skipping theme switcher')
        return
      }

      this.mediaQuery = window.matchMedia('(prefers-color-scheme: dark)')
      this.updateFavicon()
      this.mediaQuery.addEventListener('change', () => this.updateFavicon())
    }

    updateFavicon() {
      const iconUrl = this.mediaQuery.matches
        ? '/favicon-dark.png'
        : '/favicon-light.png'

      if (this.faviconLink.href.endsWith(iconUrl)) return
      this.faviconLink.href = iconUrl
    }
  }

  // Initialize favicon theme switcher
  function init() {
    try {
      new FaviconThemeSwitcher()
    } catch (error) {
      console.warn('Failed to initialize favicon theme switcher:', error)
    }
  }

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init)
  } else {
    init()
  }

  // Re-initialize on Astro page loads
  document.addEventListener('astro:page-load', init)
</script>
